<!DOCTYPE html>
<html lang="ko" dir="ltr" data-bs-theme="light" data-color-theme="Blue_Theme" data-layout="vertical"
  xmlns:th="http://www.thymeleaf.org">

<head>
  <!-- Required meta tags -->
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Favicon icon-->
  <link rel="shortcut icon" type="image/png" th:href="@{/images/logos/favicon.png}" />

  <!-- Core Css -->
  <link rel="stylesheet" th:href="@{/css/styles.css}" />

  <!-- Ajax -->
  <script th:src="@{/js/jquery-3.7.1.min.js}"></script>
  <script>
    $(function () {
      $("#memberId").on('keyup', checkId)
      $("#memberPw").on('keyup', checkPw)
      $("#memberPw2").on('keyup', pwDoubleCheck)
      $("#memberPhone").on('keyup', checkPhone)
      $("#memberEmail").on('keyup', checkEmail)
      $("#sendEmail").on('click', function () {
        // if (!checkBeforeJoin) {
        //   $("#maintainJoinPage").text("가입 정보를 입력해주세요!");
        // }

        let memberId = $("#memberId").val();
        // let memberPw = $("#memberPw").val();
        // let memberName = $("#memberName").val();
        // let memberGroup = $("#memberGroup").val();
        // let memberPhone = $("#memberPhone").val();
        let memberEmail = $("#memberEmail").val();
        // let memberEnabled = $("#memberEnabled").val();
        // let memberRole = $("#memberRole").val();
        // let uploadFile = $("#uploadFile").val();
        // console.log(uploadFile);



        //   if (!$("#termsCheckbox").is(':checked')) {
        //     alert("약관 동의에 체크해주세요");
        //     return;
        //   }

        toastr.warning("메일을 보내는 중입니다", "Progress Bar", {
          progressBar: true,
        });
        // // FormData 객체 생성
        // var formData = new FormData();

        // // JSON 데이터를 문자열로 변환하여 추가
        // var jsonData = JSON.stringify({
        //   memberId: memberId,
        //   memberPw: memberPw,
        //   memberName: memberName,
        //   memberGroup: memberGroup,
        //   memberPhone: memberPhone,
        //   memberEmail: memberEmail,
        //   memberEnabled: memberEnabled,
        //   memberRole: memberRole
        // });


        // formData.append("jsonData", new Blob([jsonData], { type: "application/json" }));

        // // 파일 추가
        // if (uploadFile) {
        //   formData.append("uploadFile", uploadFile);
        // } else {
        //   console.error("No file selected.");
        // }
        $.ajax({
          url: "/email/send",
          method: "POST",
          data: { memberId: memberId, memberEmail: memberEmail },
          success: function (resp) {
            if (!resp) alert("메일 전송에 실패하였습니다. 다시한번 시도해주세요.")
            else alert("메일을 성공적으로 전송했습니다.")
          }
        })
      });


      $("#verifyCode").on('click', function () {
        let myVerifyCode = $("#myVerifyCode").val();
        let memberId = $("#memberId").val();

        $.ajax({
          url: "/email/verifyCode"
          , method: "GET"
          , data: { memberVerifyCode: myVerifyCode, memberId: memberId }
          , success: function (resp) {
            if (!resp) alert("본인인증에 실패하였습니다. 다시한번 시도해주세요.")
            else {

              alert("본인인증에 성공했습니다. ");
              $("#maintainJoinPage").text("");
              $("#closeJoinPage").prop('hidden', false);
            }
          }
        })
      })

      $("#closeJoinPage").on('click', function () {
        if (!checkBeforeJoin()) {
          alert("가입 정보를 확인해주세요.");
          return;
        } else {
          $("#joinForm").submit();
        }
      })



    });

    function checkId() {
      let id = $("#memberId").val();
      if (id.trim().length < 8 || id.trim().length > 15) {
        $("#checkId").text("아이디는 8~15자리로 설정해주세요");
        return false;
      }
      if (id.trim().length >= 8 || id.trim().length <= 15) {
        $.ajax({
          url: "/member/checkDuplicate"
          , data: { memberId: id }
          , method: "GET"
          , success: function (resp) {
            console.log(resp);
            if (!resp) {
              $("#checkId").removeClass("text-success");
              $("#checkId").removeClass("bg-danger-subtle");
              $("#checkId").addClass("text-danger");
              $("#checkId").addClass("bg-success-subtle");
              $("#checkId").text("이미 존재하는 ID 입니다.");
              return false;
            } else {
              $("#checkId").removeClass("text-danger");
              $("#checkId").removeClass("bg-danger-subtle");
              $("#checkId").addClass("text-success");
              $("#checkId").addClass("bg-success-subtle");
              $("#checkId").text("사용 가능한 ID 입니다.")
            }

          }
        })
        return true;
      }
    };

    function checkPw() {
      let pw = $("#memberPw").val();
      if (pw.trim().length < 8 || pw.trim().length > 15) {
        $("#memberPw2").attr('readonly', true)
        $("#checkPw").text("비밀번호는 8~15자리로 설정해주세요.")
        return false;
      } else {
        $("#memberPw2").attr('readonly', false)
        $("#checkPw").text("");
        return pwDoubleCheck();
      }
    }

    function pwDoubleCheck() {
      let pw = $("#memberPw").val();
      let pw2 = $("#memberPw2").val();
      if (pw.trim() != pw2.trim()) {
        $("#pwDoubleCheck").removeClass("text-success");
        $("#pwDoubleCheck").removeClass("bg-success-subtle");
        $("#pwDoubleCheck").addClass("text-danger");
        $("#pwDoubleCheck").addClass("bg-danger-subtle");
        $("#pwDoubleCheck").text("비밀번호가 일치하지 않습니다.");
        return false;
      } else {
        $("#pwDoubleCheck").removeClass("text-danger");
        $("#pwDoubleCheck").removeClass("bg-danger-subtle");
        $("#pwDoubleCheck").addClass("text-success");
        $("#pwDoubleCheck").addClass("bg-success-subtle");
        $("#pwDoubleCheck").text("비밀번호가 일치합니다.");
        return true;
      }
    }

    function checkPhone() {
      let phone = $("#memberPhone").val();
      if (phone.trim().length != 13) {
        $("#checkPhone").text("전화번호는 '-'를 포함하여 13자리 입니다.");
        return false;
      } else {
        $("#checkPhone").text("");
        return true;
      }
    }

    function checkEmail() {
      let email = $("#memberEmail").val();
      if (email === "") {
        $("#checkEmail").html("이메일은 필수값입니다.<br>");
        return false;
      } else if (email.indexOf("@") === -1) {
        $("#checkEmail").html("올바른 이메일 형식으로 입력해주세요.");
        return false;
      } else {
        $("#checkEmail").html(null);
        return true;
      }

    }

    function checkBeforeJoin() {
      let memberName = $("#memberName").val().trim();
      let BmemberId = checkId();
      let BmemberPw = checkPw();
      let BmemberPhone = checkPhone();
      let BmemberEmail = checkEmail();

      if (!(memberName != "" && BmemberId && BmemberPw && BmemberPhone && BmemberEmail)) {
        return false;
      }
      else { return true; }

    }

  </script>

  <title>Modernize Bootstrap Admin</title>
</head>

<body>
  <!-- Preloader -->
  <div class="preloader">
    <img th:src="@{/images/logos/favicon.png}" alt="loader" class="lds-ripple img-fluid" />
  </div>
  <div id="main-wrapper" class="auth-customizer-none">
    <div
      class="position-relative overflow-hidden radial-gradient min-vh-100 w-100 d-flex align-items-center justify-content-center">
      <div class="d-flex align-items-center justify-content-center w-100">
        <div class="row justify-content-center w-100">
          <div class="col-md-8 col-lg-6 col-xxl-3 auth-card">
            <div class="card mb-0">
              <div class="card-body">
                <a href="../main/index.html" class="text-nowrap logo-img text-center d-block mb-5 w-100">
                  <p for="exampleInputEmail1" class="form-label">디마 커뮤니티</p>
                </a>
                <form id="joinForm" th:action="@{/member/join}" method="post" enctype="multipart/form-data">
                  <div class="mb-3">
                    <label for="exampleInputEmail1" class="form-label">Id</label>
                    <input type="text" name="memberId" class="form-control" id="memberId" aria-describedby="textHelp">
                    <span id="checkId" class="badge fw-semibold py-1 bg-danger-subtle text-danger"
                      style="width: 100%;"></span>
                  </div>

                  <div class="mb-3 registerblock">
                    <label for="exampleInputEmail1" class="form-label">Password
                      <input type="password" name="memberPw" id="memberPw" class="form-control mx-n1"
                        aria-describedby="textHelp">
                      <span id="checkPw" class="badge fw-semibold py-1 bg-danger-subtle text-danger checkPw"
                        style="width: 100%;"></span>
                    </label>

                    <label for="exampleInputEmail1" class="form-label">비밀번호 확인
                      <input type="password" name="memberPw2" id="memberPw2" class="form-control mx-n1"
                        aria-describedby="textHelp" readonly>
                      <span id="pwDoubleCheck" class="badge fw-semibold py-1 bg-danger-subtle text-danger checkPw"
                        style="width: 100%;"></span>
                    </label>


                  </div>
                  <div class="mb-3">
                    <label for="exampleInputEmail1" class="form-label">Name</label>
                    <input type="text" name="memberName" id="memberName" class="form-control"
                      aria-describedby="textHelp" placeholder="실명으로 작성해주세요">
                  </div>
                  <div class="mb-3">
                    <label for="exampleInputEmail1" class="form-label">기수</label>
                    <select name="memberGroup" id="memberGroup" class="form-select w-auto">
                      <option value="1기">1기</option>
                      <option value="2기">2기</option>
                      <option value="3기">3기</option>
                      <option value="4기">4기</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <label for="exampleInputEmail1" class="form-label">Tel</label>
                    <input type="text" name="memberPhone" id="memberPhone" class="form-control"
                      aria-describedby="textHelp" placeholder="000-0000-0000 형식으로 작성해주세요">
                    <span id="checkPhone" style="width: 100%;"
                      class="badge fw-semibold py-1 bg-danger-subtle text-danger"></span>
                  </div>
                  <div class="mb-3">
                    <label for="exampleInputEmail1" class="form-label">프로필 사진</label>
                    <input type="file" class="form-control" id="uploadFile" name="uploadFile">
                  </div>
                  <div class="mb-3">
                    <label for="exampleInputEmail1" class="form-label">Email address</label>
                    <input type="email" name="memberEmail" id="memberEmail" class="form-control"
                      aria-describedby="emailHelp">
                    <span id="checkEmail" style="width: 100%;"
                      class="badge fw-semibold py-1 bg-danger-subtle text-danger"></span>
                  </div>
                  <input type="hidden" name="memberEnabled" id="memberEnabled" value="N">
                  <input type="hidden" name="memberRole" id="memberRole" value="USER">
                  <div class="mb-3">
                    <input type="checkbox" class="checkbox" id="termsCheckbox" />
                    이용약관 개인정보 수집 및 이용약관에 모두 동의합니다.
                  </div>
                  <div class="mb-4">
                    <input type="button" value="이메일로 본인인증" id="sendEmail"
                      class="btn btn-outline-primary w-100 mt-4"><br>
                    <span class="registerblock">
                      <input type="text" placeholder="인증번호를 입력해주세요" id="myVerifyCode" name="myVerifyCode"
                        aria-describedby="textHelp" class="form-control emailVerifyCode">
                      <input type="button" value="인증하기" id="verifyCode" class="btn btn-primary mt-4 emailVerify">
                    </span>
                  </div>


                  <div class="d-flex align-items-center">
                    <p class="fs-4 mb-0 text-primary" id="maintainJoinPage">본인인증을 완료해
                      주세요.</p>

                    <button type="button" id="closeJoinPage" class="btn mb-1 bg-primary-subtle text-primary px-4 fs-4 "
                      hidden>
                      회원가입 완료하기
                    </button>
                    <!-- Primary Header Modal -->
                    <!-- <div id="bg-primary-header-modal" class="modal fade" tabindex="-1"
                      aria-labelledby="primary-header-modalLabel" aria-hidden="true">
                      <div class="modal-dialog modal-dialog-scrollable modal-lg">
                        <div class="modal-content modal-filled bg-primary">
                          <div class="modal-header modal-colored-header text-white">
                            <h4 class="modal-title text-white" id="primary-header-modalLabel">
                              디마 커뮤니티 가입을 환영합니다!
                            </h4>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                              aria-label="Close"></button>
                          </div>
                          <div class="modal-body">
                            <h5 class="mt-0 text-white">
                              ssehn9327@gmail.com
                            </h5>
                            <p class="text-white-50">
                              위의 이메일로 디지털 마스터 합격 메일 캡쳐본을 보내주세요! <br>
                              회원님의 이름(메일 주소)과 합격 여부를 알 수 있는 본문 내용이 함께 나오게 보내주세요.
                            </p>
                            <p class="text-white-50">
                              보안을 위해 진행되는 절차이니 조금만 양해 부탁드립니다.<br>
                              1-2일 이내로 관리자가 확인 후 승인 여부가 메일로 전송될 예정입니다.<br><br>

                              행복한 디지털 마스터 활동을 기대하겠습니다!
                            </p>
                          </div>
                          <div class="modal-footer">
                            <a href="/main" class="btn btn-light">메인으로 돌아가기</a> -->

                  </div>
              </div>
              <!-- /.modal-content -->
            </div>
            <!-- /.modal-dialog -->
          </div>
          <!-- /.modal -->
          <!-- <a class="text-primary fw-medium ms-2" href="../main/authentication-login.html">Sign In</a> -->
        </div>
        </form>
      </div>
    </div>
  </div>
  </div>
  </div>
  </div>
  <script>
    function handleColorTheme(e) {
      document.documentElement.setAttribute("data-color-theme", e);
    }
  </script>
  <button class="btn btn-primary p-3 rounded-circle d-flex align-items-center justify-content-center customizer-btn"
    type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasExample" aria-controls="offcanvasExample">
    <i class="icon ti ti-settings fs-7"></i>
  </button>

  <div class="offcanvas customizer offcanvas-end" tabindex="-1" id="offcanvasExample"
    aria-labelledby="offcanvasExampleLabel">
    <div class="d-flex align-items-center justify-content-between p-3 border-bottom">
      <h4 class="offcanvas-title fw-semibold" id="offcanvasExampleLabel">
        Settings
      </h4>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body h-n80" data-simplebar>
      <h6 class="fw-semibold fs-4 mb-2">Theme</h6>

      <div class="d-flex flex-row gap-3 customizer-box" role="group">
        <input type="radio" class="btn-check light-layout" name="theme-layout" id="light-layout" autocomplete="off" />
        <label class="btn p-9 btn-outline-primary rounded-2" for="light-layout">
          <i class="icon ti ti-brightness-up fs-7 me-2"></i>Light
        </label>

        <input type="radio" class="btn-check dark-layout" name="theme-layout" id="dark-layout" autocomplete="off" />
        <label class="btn p-9 btn-outline-primary rounded-2" for="dark-layout">
          <i class="icon ti ti-moon fs-7 me-2"></i>Dark
        </label>
      </div>

      <h6 class="mt-5 fw-semibold fs-4 mb-2">Theme Direction</h6>
      <div class="d-flex flex-row gap-3 customizer-box" role="group">
        <input type="radio" class="btn-check" name="direction-l" id="ltr-layout" autocomplete="off" />
        <label class="btn p-9 btn-outline-primary" for="ltr-layout">
          <i class="icon ti ti-text-direction-ltr fs-7 me-2"></i>LTR
        </label>

        <input type="radio" class="btn-check" name="direction-l" id="rtl-layout" autocomplete="off" />
        <label class="btn p-9 btn-outline-primary" for="rtl-layout">
          <i class="icon ti ti-text-direction-rtl fs-7 me-2"></i>RTL
        </label>
      </div>

      <h6 class="mt-5 fw-semibold fs-4 mb-2">Theme Colors</h6>

      <div class="d-flex flex-row flex-wrap gap-3 customizer-box color-pallete" role="group">
        <input type="radio" class="btn-check" name="color-theme-layout" id="Blue_Theme" autocomplete="off" />
        <label class="btn p-9 btn-outline-primary d-flex align-items-center justify-content-center"
          onclick="handleColorTheme('Blue_Theme')" for="Blue_Theme" data-bs-toggle="tooltip" data-bs-placement="top"
          data-bs-title="BLUE_THEME">
          <div class="color-box rounded-circle d-flex align-items-center justify-content-center skin-1">
            <i class="ti ti-check text-white d-flex icon fs-5"></i>
          </div>
        </label>

        <input type="radio" class="btn-check" name="color-theme-layout" id="Aqua_Theme" autocomplete="off" />
        <label class="btn p-9 btn-outline-primary d-flex align-items-center justify-content-center"
          onclick="handleColorTheme('Aqua_Theme')" for="Aqua_Theme" data-bs-toggle="tooltip" data-bs-placement="top"
          data-bs-title="AQUA_THEME">
          <div class="color-box rounded-circle d-flex align-items-center justify-content-center skin-2">
            <i class="ti ti-check text-white d-flex icon fs-5"></i>
          </div>
        </label>

        <input type="radio" class="btn-check" name="color-theme-layout" id="Purple_Theme" autocomplete="off" />
        <label class="btn p-9 btn-outline-primary d-flex align-items-center justify-content-center"
          onclick="handleColorTheme('Purple_Theme')" for="Purple_Theme" data-bs-toggle="tooltip" data-bs-placement="top"
          data-bs-title="PURPLE_THEME">
          <div class="color-box rounded-circle d-flex align-items-center justify-content-center skin-3">
            <i class="ti ti-check text-white d-flex icon fs-5"></i>
          </div>
        </label>

        <input type="radio" class="btn-check" name="color-theme-layout" id="green-theme-layout" autocomplete="off" />
        <label class="btn p-9 btn-outline-primary d-flex align-items-center justify-content-center"
          onclick="handleColorTheme('Green_Theme')" for="green-theme-layout" data-bs-toggle="tooltip"
          data-bs-placement="top" data-bs-title="GREEN_THEME">
          <div class="color-box rounded-circle d-flex align-items-center justify-content-center skin-4">
            <i class="ti ti-check text-white d-flex icon fs-5"></i>
          </div>
        </label>

        <input type="radio" class="btn-check" name="color-theme-layout" id="cyan-theme-layout" autocomplete="off" />
        <label class="btn p-9 btn-outline-primary d-flex align-items-center justify-content-center"
          onclick="handleColorTheme('Cyan_Theme')" for="cyan-theme-layout" data-bs-toggle="tooltip"
          data-bs-placement="top" data-bs-title="CYAN_THEME">
          <div class="color-box rounded-circle d-flex align-items-center justify-content-center skin-5">
            <i class="ti ti-check text-white d-flex icon fs-5"></i>
          </div>
        </label>

        <input type="radio" class="btn-check" name="color-theme-layout" id="orange-theme-layout" autocomplete="off" />
        <label class="btn p-9 btn-outline-primary d-flex align-items-center justify-content-center"
          onclick="handleColorTheme('Orange_Theme')" for="orange-theme-layout" data-bs-toggle="tooltip"
          data-bs-placement="top" data-bs-title="ORANGE_THEME">
          <div class="color-box rounded-circle d-flex align-items-center justify-content-center skin-6">
            <i class="ti ti-check text-white d-flex icon fs-5"></i>
          </div>
        </label>
      </div>

      <h6 class="mt-5 fw-semibold fs-4 mb-2">Layout Type</h6>
      <div class="d-flex flex-row gap-3 customizer-box" role="group">
        <div>
          <input type="radio" class="btn-check" name="page-layout" id="vertical-layout" autocomplete="off" />
          <label class="btn p-9 btn-outline-primary" for="vertical-layout">
            <i class="icon ti ti-layout-sidebar-right fs-7 me-2"></i>Vertical
          </label>
        </div>
        <div>
          <input type="radio" class="btn-check" name="page-layout" id="horizontal-layout" autocomplete="off" />
          <label class="btn p-9 btn-outline-primary" for="horizontal-layout">
            <i class="icon ti ti-layout-navbar fs-7 me-2"></i>Horizontal
          </label>
        </div>
      </div>

      <h6 class="mt-5 fw-semibold fs-4 mb-2">Container Option</h6>

      <div class="d-flex flex-row gap-3 customizer-box" role="group">
        <input type="radio" class="btn-check" name="layout" id="boxed-layout" autocomplete="off" />
        <label class="btn p-9 btn-outline-primary" for="boxed-layout">
          <i class="icon ti ti-layout-distribute-vertical fs-7 me-2"></i>Boxed
        </label>

        <input type="radio" class="btn-check" name="layout" id="full-layout" autocomplete="off" />
        <label class="btn p-9 btn-outline-primary" for="full-layout">
          <i class="icon ti ti-layout-distribute-horizontal fs-7 me-2"></i>Full
        </label>
      </div>

      <h6 class="fw-semibold fs-4 mb-2 mt-5">Sidebar Type</h6>
      <div class="d-flex flex-row gap-3 customizer-box" role="group">
        <a href="javascript:void(0)" class="fullsidebar">
          <input type="radio" class="btn-check" name="sidebar-type" id="full-sidebar" autocomplete="off" />
          <label class="btn p-9 btn-outline-primary" for="full-sidebar">
            <i class="icon ti ti-layout-sidebar-right fs-7 me-2"></i>Full
          </label>
        </a>
        <div>
          <input type="radio" class="btn-check " name="sidebar-type" id="mini-sidebar" autocomplete="off" />
          <label class="btn p-9 btn-outline-primary" for="mini-sidebar">
            <i class="icon ti ti-layout-sidebar fs-7 me-2"></i>Collapse
          </label>
        </div>
      </div>

      <h6 class="mt-5 fw-semibold fs-4 mb-2">Card With</h6>

      <div class="d-flex flex-row gap-3 customizer-box" role="group">
        <input type="radio" class="btn-check" name="card-layout" id="card-with-border" autocomplete="off" />
        <label class="btn p-9 btn-outline-primary" for="card-with-border">
          <i class="icon ti ti-border-outer fs-7 me-2"></i>Border
        </label>

        <input type="radio" class="btn-check" name="card-layout" id="card-without-border" autocomplete="off" />
        <label class="btn p-9 btn-outline-primary" for="card-without-border">
          <i class="icon ti ti-border-none fs-7 me-2"></i>Shadow
        </label>
      </div>
    </div>
  </div>
  </div>
  <div class="dark-transparent sidebartoggler"></div>
  <!-- Import Js Files -->
  <script th:src="@{/libs/bootstrap/dist/js/bootstrap.bundle.min.js}"></script>
  <script th:src="@{/libs/simplebar/dist/simplebar.min.js}"></script>
  <script th:src="@{/js/theme/app.init.js}"></script>
  <script th:src="@{/js/theme/theme.js}"></script>
  <script th:src="@{/js/theme/app.min.js}"></script>
  <script th:src="@{/js/plugins/toastr-init.js}"></script>

  <!-- solar icons -->
  <script src="https://cdn.jsdelivr.net/npm/iconify-icon@1.0.8/dist/iconify-icon.min.js"></script>
</body>

</html>